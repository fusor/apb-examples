FROM ansibleplaybookbundle/apb-base
# MAINTAINER {{ $MAINTAINER }}

LABEL "com.redhat.apb.version"="0.1.0"
LABEL "com.redhat.apb.spec"=\
"aWQ6IDc1ZTNjMGE3LWY3YjEtNDdkNy1iMTM3LTMyODNmNmZjNzM2ZApuYW1lOiBiaW5kLXBxLWFw\
YgppbWFnZTogc2h1cmxleS9yaHNjbC1wb3N0Z3Jlc3FsLWFwYgpkZXNjcmlwdGlvbjogU0NMIFBv\
c3RncmVTUUwgYXBiIGltcGxlbWVudGF0aW9uCmJpbmRhYmxlOiBUcnVlCmFzeW5jOiBvcHRpb25h\
bAptZXRhZGF0YTogCiAgZG9jdW1lbnRhdGlvblVybDogaHR0cHM6Ly93d3cucG9zdGdyZXNxbC5v\
cmcvZG9jcy8KICBsb25nRGVzY3JpcHRpb246IEFuIGFwYiB0aGF0IGRlcGxveXMgcG9zdGdyZXNx\
bCA5LjQgb3IgOS41LgogIGRlcGVuZGVuY2llczogWydyZWdpc3RyeS5hY2Nlc3MucmVkaGF0LmNv\
bS9yaHNjbC9wb3N0Z3Jlc3FsLTk1LXJoZWw3J10KICBkaXNwbGF5TmFtZTogQmluZCBQb3N0Z3Jl\
U1FMIChBUEIpCiAgY29uc29sZS5vcGVuc2hpZnQuaW8vaWNvbkNsYXNzOiBpY29uLXBvc3RncmVz\
cWwKICAKcGxhbnM6CiAgLSBuYW1lOiBkZWZhdWx0CiAgICBkZXNjcmlwdGlvbjogQSBzaW5nbGUg\
ZXRoZXJwYWQgYXBwbGljYXRpb24gd2l0aCBubyBEQgogICAgZnJlZTogdHJ1ZQogICAgbWV0YWRh\
dGE6CiAgICAgIGRpc3BsYXlOYW1lOiBEZWZhdWx0CiAgICAgIGxvbmdEZXNjcmlwdGlvbjogVGhp\
cyBwbGFuIHByb3ZpZGVzIGEgc2luZ2xlIEV0aGVycGFkIGFwcGxpY2F0aW9uIHdpdGggbm8gZGF0\
YWJhc2VcCiAgICAgIGNvc3Q6ICQwLjAwCgogICAgcGFyYW1ldGVyczogCiAgICAgIC0gbmFtZTog\
cG9zdGdyZXNxbF9kYXRhYmFzZQogICAgICAgIGRlZmF1bHQ6IGFkbWluCiAgICAgICAgdHlwZTog\
c3RyaW5nCiAgICAgICAgdGl0bGU6IFBvc3RncmVTUUwgRGF0YWJhc2UgTmFtZQogICAgICAgIHJl\
cXVpcmVkOiBUcnVlCiAgICAgIAogICAgICAtIG5hbWU6IHBvc3RncmVzcWxfcGFzc3dvcmQKICAg\
ICAgICB0eXBlOiBzdHJpbmcKICAgICAgICBkZXNjcmlwdGlvbjogQSByYW5kb20gYWxwaGFudW1l\
cmljIHN0cmluZyBpZiBsZWZ0IGJsYW5rCiAgICAgICAgdGl0bGU6IFBvc3RncmVTUUwgUGFzc3dv\
cmQKICAgICAgICAgIAogICAgICAtIG5hbWU6IHBvc3RncmVzcWxfc2luZ2xlX3VzZXIKICAgICAg\
ICB0eXBlOiBlbnVtCiAgICAgICAgZGVzY3JpcHRpb246IFNob3VsZCB0aGUgZGF0YWJhc2UgY3Jl\
YXRlIG5ldyB1c2VyIG9uIGVhY2ggYmluZGluZyBvciByZS11c2UgYSBzaW5nbGUgdXNlci4KICAg\
ICAgICB0aXRsZTogU2luZ2xlIFVzZXIgb3IgTXVsdGlwbGUgVXNlcnMKICAgICAgICBlbnVtOiBb\
J3NpbmdsZScsICdtdWx0aXBsZSddCiAgICAgICAgcmVxdWlyZWQ6IHRydWUKICAgICAgICAgICAg\
ICAKICAgICAgLSBuYW1lOiBwb3N0Z3Jlc3FsX3ZlcnNpb24KICAgICAgICBkZWZhdWx0OiA5LjUK\
ICAgICAgICBlbnVtOiBbJzkuNScsICc5LjQnXQogICAgICAgIHR5cGU6IGVudW0KICAgICAgICBy\
ZXF1aXJlZDogdHJ1ZQogICAgICAgIHRpdGxlOiBQb3N0Z3JlU1FMIFZlcnNpb24KICAgICAgCmRl\
cGVuZGVuY2llczogCiAgLSBwb3N0Z3Jlc3FsX3ZlcnNpb24KICAtIHJlZ2lzdHJ5LmFjY2Vzcy5y\
ZWRoYXQuY29tL3Joc2NsL3t7CiAgCg=="

RUN yum -y install postgresql-libs python-psycopg2 && yum clean all
COPY roles /opt/ansible/roles
COPY playbooks/* /opt/apb/actions/

USER apb
