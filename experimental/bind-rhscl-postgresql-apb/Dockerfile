FROM ansibleplaybookbundle/apb-base
# MAINTAINER {{ $MAINTAINER }}

LABEL "com.redhat.apb.version"="0.1.0"
LABEL "com.redhat.apb.spec"=\
"aWQ6IDc1ZTNjMGE3LWY3YjEtNDdkNy1iMTM3LTMyODNmNmZjNzM2ZApuYW1lOiBiaW5kLXBvc3Rn\
cmVzcWwtYXBiCmltYWdlOiBzaHVybGV5L2JpbmQtcG9zdGdyZXNxbC1hcGIKZGVzY3JpcHRpb246\
IFNDTCBQb3N0Z3JlU1FMIGFwYiBpbXBsZW1lbnRhdGlvbgpiaW5kYWJsZTogVHJ1ZQphc3luYzog\
b3B0aW9uYWwKbWV0YWRhdGE6IAogIGRvY3VtZW50YXRpb25Vcmw6IGh0dHBzOi8vd3d3LnBvc3Rn\
cmVzcWwub3JnL2RvY3MvCiAgbG9uZ0Rlc2NyaXB0aW9uOiBBbiBhcGIgdGhhdCBkZXBsb3lzIHBv\
c3RncmVzcWwgOS40IG9yIDkuNS4KICBkZXBlbmRlbmNpZXM6IFsncmVnaXN0cnkuYWNjZXNzLnJl\
ZGhhdC5jb20vcmhzY2wvcG9zdGdyZXNxbC05NS1yaGVsNyddCiAgZGlzcGxheU5hbWU6IEJpbmQg\
UG9zdGdyZVNRTCAoQVBCKQogIGNvbnNvbGUub3BlbnNoaWZ0LmlvL2ljb25DbGFzczogaWNvbi1w\
b3N0Z3Jlc3FsCiAgCnBsYW5zOgogIC0gbmFtZTogZGVmYXVsdAogICAgZGVzY3JpcHRpb246IEEg\
c2luZ2xlIGV0aGVycGFkIGFwcGxpY2F0aW9uIHdpdGggbm8gREIKICAgIGZyZWU6IHRydWUKICAg\
IG1ldGFkYXRhOgogICAgICBkaXNwbGF5TmFtZTogRGVmYXVsdAogICAgICBsb25nRGVzY3JpcHRp\
b246IFRoaXMgcGxhbiBwcm92aWRlcyBhIHNpbmdsZSBFdGhlcnBhZCBhcHBsaWNhdGlvbiB3aXRo\
IG5vIGRhdGFiYXNlXAogICAgICBjb3N0OiAkMC4wMAoKICAgIHBhcmFtZXRlcnM6IAogICAgICAt\
IG5hbWU6IHBvc3RncmVzcWxfZGF0YWJhc2UKICAgICAgICBkZWZhdWx0OiBhZG1pbgogICAgICAg\
IHR5cGU6IHN0cmluZwogICAgICAgIHRpdGxlOiBQb3N0Z3JlU1FMIERhdGFiYXNlIE5hbWUKICAg\
ICAgICByZXF1aXJlZDogVHJ1ZQogICAgICAKICAgICAgLSBuYW1lOiBwb3N0Z3Jlc3FsX3Bhc3N3\
b3JkCiAgICAgICAgdHlwZTogc3RyaW5nCiAgICAgICAgZGVzY3JpcHRpb246IEEgcmFuZG9tIGFs\
cGhhbnVtZXJpYyBzdHJpbmcgaWYgbGVmdCBibGFuawogICAgICAgIHRpdGxlOiBQb3N0Z3JlU1FM\
IFBhc3N3b3JkCiAgICAgICAgICAKICAgICAgLSBuYW1lOiBwb3N0Z3Jlc3FsX3NpbmdsZV91c2Vy\
CiAgICAgICAgdHlwZTogZW51bQogICAgICAgIGRlc2NyaXB0aW9uOiBTaG91bGQgdGhlIGRhdGFi\
YXNlIGNyZWF0ZSBuZXcgdXNlciBvbiBlYWNoIGJpbmRpbmcgb3IgcmUtdXNlIGEgc2luZ2xlIHVz\
ZXIuCiAgICAgICAgdGl0bGU6IFNpbmdsZSBVc2VyIG9yIE11bHRpcGxlIFVzZXJzCiAgICAgICAg\
ZW51bTogWydzaW5nbGUnLCAnbXVsdGlwbGUnXQogICAgICAgIHJlcXVpcmVkOiB0cnVlCiAgICAg\
ICAgICAgICAgCiAgICAgIC0gbmFtZTogcG9zdGdyZXNxbF92ZXJzaW9uCiAgICAgICAgZGVmYXVs\
dDogOS41CiAgICAgICAgZW51bTogWyc5LjUnLCAnOS40J10KICAgICAgICB0eXBlOiBlbnVtCiAg\
ICAgICAgcmVxdWlyZWQ6IHRydWUKICAgICAgICB0aXRsZTogUG9zdGdyZVNRTCBWZXJzaW9uCiAg\
ICAgIApkZXBlbmRlbmNpZXM6IAogIC0gcG9zdGdyZXNxbF92ZXJzaW9uCiAgLSByZWdpc3RyeS5h\
Y2Nlc3MucmVkaGF0LmNvbS9yaHNjbC97ewogIAo="

RUN yum -y install postgresql-libs python-psycopg2 && yum clean all
COPY roles /opt/ansible/roles
COPY playbooks/* /opt/apb/actions/

USER apb
