FROM ansibleplaybookbundle/apb-src-base
# MAINTAINER {{ $MAINTAINER }}

LABEL "com.redhat.apb.version"="0.1.0"
LABEL "com.redhat.apb.spec"=\
"aWQ6IDgyNjYyZWQ2LTI2Y2EtNDFhNS1hNzMxLTllMjIxMzJkNDc4MQpuYW1lOiBhbnNpYmxlYXBw\
L2ZvcmVtYW4tYW5zaWJsZWFwcApkZXNjcmlwdGlvbjogRm9yZW1hbiBhbnNpYmxlYXBwIGltcGxl\
bWVudGF0aW9uCmJpbmRhYmxlOiBmYWxzZQphc3luYzogb3B0aW9uYWwKcGFyYW1ldGVyczoKICAt\
IG5hbWU6IGNlcnRpZmljYXRlX2NuCiAgICBkZXNjcmlwdGlvbjogQ29tbW9uIE5hbWUgZm9yIFNT\
TCBDZXJ0aWZpY2F0ZQogICAgdHlwZTogc3RyaW5nCiAgICBkZWZhdWx0OiBmb3JlbWFuCiAgLSBu\
YW1lOiBjcmVhdGVfcHZzCiAgICBkZXNjcmlwdGlvbjogQ3JlYXRlIGhvc3RQYXRoIFBWJ3MKICAg\
IHR5cGU6IGJvb2xlYW4KICAgIGRlZmF1bHQ6IGZhbHNlCiAgLSBuYW1lOiBkZXBsb3lfcG9zdGdy\
ZXNxbAogICAgZGVzY3JpcHRpb246IERlcGxveSBhIGRlZGljYXRlZCBwb3N0Z3Jlc3FsIGluc3Rh\
bmNlCiAgICB0eXBlOiBib29sZWFuCiAgICBkZWZhdWx0OiB0cnVlCiAgLSBuYW1lOiBkYl9lbmNy\
eXB0aW9uX2tleQogICAgZGVzY3JpcHRpb246IERCIEVuY3J5cHRpb24ga2V5CiAgICBkZWZhdWx0\
OiAnJwogICAgcmVxdWlyZWQ6IGZhbHNlCiAgLSBuYW1lOiBmb3JlbWFuX2FkbWluX3Bhc3N3b3Jk\
IAogICAgZGVzY3JpcHRpb246IGZvcmVtYW4gYWRtaW4gcGFzc3dvcmQKICAgIHR5cGU6IHN0cmlu\
ZwogICAgZGVmYXVsdDogY2hhbmdlbWUKICAtIG5hbWU6IG5hbWVzcGFjZQogICAgZGVzY3JpcHRp\
b246IE5hbWVzcGFjZSB0byBkZXBsb3kgdGhlIGNsdXN0ZXIgdG8KICAgIHR5cGU6IHN0cmluZwog\
ICAgZGVmYXVsdDogZm9yZW1hbi1hbnNpYmxlYXBwCiAgLSBuYW1lOiBwb3N0Z3Jlc3FsX2RhdGFi\
YXNlCiAgICBkZXNjcmlwdGlvbjogcG9zdGdyZXNxbCBkYXRhYmFzZSBuYW1lCiAgICB0eXBlOiBz\
dHJpbmcKICAgIGRlZmF1bHQ6IGZvcmVtYW4KICAtIG5hbWU6IHBvc3RncmVzcWxfaG9zdG5hbWUK\
ICAgIGRlc2NyaXB0aW9uOiBob3N0bmFtZSBvZiBwb3N0Z3Jlc3FsIGRhdGFiYXNlLiBVc2UgZGVm\
YXVsdCBpZiBkZXBsb3lpbmcgYSBkZWRpY2F0ZWQgaW5zdGFuY2UKICAgIHR5cGU6IHN0cmluZwog\
ICAgZGVmYXVsdDogdGZtLXBvc3RncmVzcWwKICAtIG5hbWU6IHBvc3RncmVzcWxfcGFzc3dvcmQK\
ICAgIGRlc2NyaXB0aW9uOiBwb3N0Z3Jlc3FsIGRhdGFiYXNlIHBhc3N3b3JkCiAgICB0eXBlOiBz\
dHJpbmcKICAgIGRlZmF1bHQ6IGFkbWluCiAgLSBuYW1lOiBwb3N0Z3Jlc3FsX3VzZXIKICAgIGRl\
c2NyaXB0aW9uOiBwb3N0Z3Jlc3FsIGRhdGFiYXNlIHVzZXJuYW1lCiAgICB0eXBlOiBzdHJpbmcK\
ICAgIGRlZmF1bHQ6IGFkbWluCiAgLSBuYW1lOiBwdl9iYXNlX3BhdGgKICAgIGRlc2NyaXB0aW9u\
OiBCYXNlIHBhdGggZm9yIGhvc3RQYXRoIHB2J3MgaWYgY3JlYXRlZAogICAgdHlwZTogc3RyaW5n\
CiAgICBkZWZhdWx0OiAvb3B0L2s4cwogIC0gbmFtZTogdXNlX2NuX2Zvcl9yb3V0ZV9ob3N0bmFt\
ZQogICAgZGVzY3JpcHRpb246IENoYW5nZSB0aGUgcm91dGUgaG9zdG5hbWUgdG8gbWF0Y2ggdGhl\
IGNlcnRpZmljYXRlX2NuCiAgICB0eXBlOiBib29sZWFuCiAgICBkZWZhdWx0OiBmYWxzZQogIC0g\
bmFtZTogdmVyc2lvbgogICAgZGVzY3JpcHRpb246IENoYW5nZSB0aGUgcm91dGUgaG9zdG5hbWUg\
dG8gbWF0Y2ggdGhlIGNlcnRpZmljYXRlX2NuCiAgICB0eXBlOiBzdHJpbmcKICAgIGRlZmF1bHQ6\
IDEuMTQK"

ADD foreman /opt/foreman 
RUN yum -y install openssl && yum clean all

ADD playbooks /opt/apb/actions
ADD roles /opt/ansible/roles

USER apb
