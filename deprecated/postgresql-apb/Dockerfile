FROM ansibleplaybookbundle/apb-src-base
MAINTAINER Ansible Playbook Bundle Community

LABEL "com.redhat.apb.version"="0.1.0"
LABEL "com.redhat.apb.spec"=\
"aWQ6IDI2MzU1ZDFhLTAzMDEtNDg0MS04NWFmLTUzNmE0ZDNhZmFhOQpuYW1lOiBwb3N0Z3Jlc3Fs\
LWFwYgppbWFnZTogYW5zaWJsZXBsYXlib29rYnVuZGxlL3Bvc3RncmVzcWwtYXBiCmRlc2NyaXB0\
aW9uOiBQb3N0Z3JlU1FMIGFwYiBpbXBsZW1lbnRhdGlvbgpiaW5kYWJsZTogdHJ1ZQphc3luYzog\
b3B0aW9uYWwKdGFnczoKICAtIGRhdGFiYXNlCm1ldGFkYXRhOgogIGRpc3BsYXlOYW1lOiAicG9z\
dGdyZXNxbCIKICBsb25nRGVzY3JpcHRpb246ICJEZXBsb3lzIGEgYmluZGFibGUgcG9zdGdyZXMg\
aW5zdGFuY2UiCiAgaW1hZ2VVcmw6ICJodHRwczovL3VwbG9hZC53aWtpbWVkaWEub3JnL3dpa2lw\
ZWRpYS9jb21tb25zL3RodW1iLzIvMjkvUG9zdGdyZXNxbF9lbGVwaGFudC5zdmcvNjRweC1Qb3N0\
Z3Jlc3FsX2VsZXBoYW50LnN2Zy5wbmciCiAgZG9jdW1lbnRhdGlvblVybDogImh0dHBzOi8vd3d3\
LnBvc3RncmVzcWwub3JnL2RvY3MvIgpwYXJhbWV0ZXJzOgogIC0gbmFtZTogbmFtZXNwYWNlCiAg\
ICBkZXNjcmlwdGlvbjogTmFtZXNwYWNlIHRvIGRlcGxveSB0aGUgY2x1c3RlciB0bwogICAgdHlw\
ZTogc3RyaW5nCiAgICBkZWZhdWx0OiBwb3N0Z3Jlc3FsLWFwYgogIC0gbmFtZTogcG9zdGdyZXNx\
bF9kYXRhYmFzZQogICAgZGVzY3JpcHRpb246IHBvc3RncmVzcWwgZGF0YWJhc2UgbmFtZQogICAg\
dHlwZTogc3RyaW5nCiAgICBkZWZhdWx0OiBhZG1pbgogIC0gbmFtZTogcG9zdGdyZXNxbF9wYXNz\
d29yZAogICAgZGVzY3JpcHRpb246IHBvc3RncmVzcWwgZGF0YWJhc2UgcGFzc3dvcmQKICAgIHR5\
cGU6IHN0cmluZwogICAgZGVmYXVsdDogYWRtaW4KICAtIG5hbWU6IHBvc3RncmVzcWxfdXNlcgog\
ICAgZGVzY3JpcHRpb246IHBvc3RncmVzcWwgZGF0YWJhc2UgdXNlcm5hbWUKICAgIHR5cGU6IHN0\
cmluZwogICAgZGVmYXVsdDogYWRtaW4K"

COPY roles /opt/ansible/roles
COPY playbooks /opt/apb/actions
RUN chmod -R g=u /opt/{ansible,apb}

USER apb
